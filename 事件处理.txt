考虑事件处理

1､数据表定义

系统事件定义表（与事件检测的事件一一对应）
id
event_code
event_name


预案定义表（plan)
plan_id
plan_code   预案编号（可用YA-201801,也可保留随便添)
plan_name   名称
plan_desc   描述
plan_enable 1-启用  0-停用
event_code  对应事件编号
plan_user   输入人员
plan_at     建立日期时间



预案执行通知单位(plan_notify)
id
plan_id    预案ID
pn_order   执行步骤 与 设备动作 联合排序（JOSN发送两个，前端处理）
pn_notify  单位或人员
pn_phone   电话
pn_message 通告内容

预案执行设备动作（plan_action)
id
plan_id       预案ID
pa_order      执行步骤
pa_devtype    设备类型。  涉及：风机、照明、情报板、车道指示标志、交通信号灯、卷帘门（每个设备单独一个界面）
              针对照明可以按照明模式进行控制。即 照明棋块具有模式控制命令。
              范围：事件所在隧洞、
              风机在火灾情况下，须现场调度人员指挥进行操作。在交通情况下可以控制。
              风机控制可以按隧道内风机组、启动比例（全部、3/4､一半、1/4)：控制正转、反转。 
              范围：事件点前方、事件点后方。
              车道指示器：上行、下行、禁行，位置：行车道、超车道、紧急停车带，
              事件点前：本隧道内，前方封闭区域
              事件点后：本隧道内，后方封闭区域
              交通信号灯：红、绿、黄、转向（转向一般用于隧道口有向对向的通道，适用于对端隧道封闭时，车辆驶回）
              位置：同车道指标标志
              情报板：这个东西最多。不同情报板按类型进行了区分。因此，制作时按情报板类型分别进行。
              1､悬挂、门架、悬臂
              2､接事件点前方、事件所在封闭路段前、事件点后。


pa_action     设备动作JSON
pa_desc       设备动作文字描述
pa_choice     设备选择方式 1-指定具体的设备，
pa_devs       指定的设备编号列表

pa_front      事故点前方 多远，单位：米
pa_rear       事故点后方 多远，单位：米  

前方封闭区域内所有该类设备
前方封闭区域前
后方封闭区域
后方封闭区域后。


封闭区域 包括：事件前方是否可驶离高速公路，事件前方是否可进入高速公路
封闭区域的定义？服务区算什么？？




考虑封闭路段的表示。

1､ 常：车行横洞位置是如何定义的？重点在借道疏散。
2､ 页面分为2个，通知和执行动作
3､ 考虑后台实现图形的处理，双击事件、请求实时个数
4､ 考虑将控制和采集方式全部改为POST方式，以有效的实现通用性。
   重点考虑执行时，执行时，发送控制命令。


设备动作表？？





预案执行记录表(plan_history)
id
plan_code

plan_at
plan_user




界面如何：

当前界面显示内容










	